#!/bin/bash
#git recursive directories scripts - http://safrm.net/projects/gr-scripts
#author: Miroslav Safr <miroslav.safr@gmail.com>
#search for inappropriate commits
#
#gr-authorcheck <SEARCHED_PATTERN> [<DIR>]
#  searching is case sensitive
VERSION=NA                                                                   
VERSION_DATE=NA

WHAT="$1"
if [ -z "$WHAT" ]; then 
    echo "You have to specify searching pattern, exiting.."; exit 1;
fi

PROJECT_DIR="$2"
if [ -z "$PROJECT_DIR" ] || [ ! -d "$PROJECT_DIR" ]; then
	PROJECT_DIR="./"
fi

CWD=`pwd`
cd $PROJECT_DIR
PROJECT_DIR=`pwd`
find $PROJECT_DIR -type d -name ".git*"  |  sed 's/\/.git//g' | sort | while read ENTRY
do
	cd $ENTRY 
    echo $ENTRY:
	git --no-pager log --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset'  --author=$WHAT --committer=$WHAT
	cd $CWD
done

TIME=`date +%H:%M:%S`
echo "gr-clean finished:$TIME"




